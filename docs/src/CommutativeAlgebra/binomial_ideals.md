```@meta
CurrentModule = Oscar
```

```@setup oscar
using Oscar
```

```@contents
Pages = ["ca_binomial_ideals.md"]
```

# Binomial Primary Decomposition

## Introduction

A *binomial* is a polynomial consisting of at most two terms. A *binomial ideal*
is an ideal which can be generated by binomials. A *binomial primary decomposition*
is a primary decomposition of a binomial ideal into primary ideals which are binomial
as well. In this section, focusing on polynomial rings over fields, we discuss functionality
for computing such decompositions.

We begin by recalling that a proper ideal $I$ of a polynomial ring $K[x_1, \dots, x_n]$ over a field $K$ is called *cellular* if each variable $x_i$ is either a nonzerodivisor or nilpotent modulo $I$.
A *cellular decomposition* of a proper binomial ideal $I$ of $K[x_1, \dots, x_n]$ is a decomposition of $I$ into cellular binomial ideals.
It is not too difficult to show that such decompositions always exist (use Noetherian induction). 

With this notation, the algorithms for computing binomial primary decompositions proceed in two main steps:

- First, compute a cellular decomposition of the given binomial ideal.
- Then, decompose each cellular component into primary binomial ideals.

While the first step can be performed over any ground field for which Gr√∂bner bases are implemented, the second step may require a field extension: From a theoretical point of view, the existence of binomial primary decompositions is only guaranteed if the ground field is algebraically closed.

!!! note
    A *pure difference binomial* is a binomial which is the difference of two monomials. A *unital binomial ideal* is an ideal which can be generated by pure difference binomials and monomials. For unital binomial ideals with coefficients in $\mathbb Q$, absolute binomial primary decompositions exist already over extensions of $\mathbb Q$ which are obtained by adjoining a finite number of roots of unity. Thus, all these cases can be covered by working over the abelian closure $\mathbb Q^{\text{ab}}$ of $\mathbb Q$ (see the number therory chapter for how to handle $\mathbb Q^{\text{ab}}$ in OSCAR).

    Currently, functionality for decomposing cellular binomial ideals and, thus, for the second step above is only implemented for cellular binomial ideals which are unital and defined over $\mathbb Q.$

!!! note
    Binomial primary decompositions computed with OSCAR are not necessarily minimal.

Papers offering details on theory and algorithms as well as examples include:

- [ES96](@cite)
- [OMdCS00](@cite)
- [Kah10](@cite)
- [EM16](@cite)
- [EM19](@cite)

## Basic Tests

### Binomiality Test

```@docs
isbinomial(f::MPolyElem)
isbinomial(I::MPolyIdeal)
```
```@repl oscar
R, (x, y, z) = PolynomialRing(QQ, ["x", "y", "z"])
f = 2*x+y
isbinomial(f)
J = ideal(R, [x^2-y^3, z^2])
isbinomial(J)
```

### Cellularity Test

```@docs
iscellular(I::MPolyIdeal)
```

### Unitality Test

```@docs
isunital(I::MPolyIdeal)
```



## Cellular Decomposition

```@docs
cellular_decomposition(I::MPolyIdeal)
```

## Primary Decomposition of Cellular Ideals

```@docs
cellular_hull(I::MPolyIdeal)
```

```@docs
cellular_associated_primes(I::MPolyIdeal{fmpq_mpoly})
```

```@docs
cellular_minimal_associated_primes(I::MPolyIdeal{fmpq_mpoly})
```

```@docs
cellular_primary_decomposition(I::MPolyIdeal{fmpq_mpoly})
```

## Primary Decomposition of Binomial  Ideals

```@docs
binomial_primary_decomposition(I::MPolyIdeal{fmpq_mpoly})
```


