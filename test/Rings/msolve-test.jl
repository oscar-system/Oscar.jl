@testset "msolve" begin
    R,(x,y) = PolynomialRing(QQ, ["x","y"])
    I = ideal(R,[x+13*y,x^2*y-12//5*y^2-x])
    singular_assure(I)
    res = Int32[2, 3], BigInt[1, 1, 13, 1, 1, 1, -12, 5, -1, 1], Int32[1, 0, 0, 1, 2, 1, 0, 2, 1, 0]
    @test Oscar.convert_singular_ideal_to_array(I.gens.S) == res
    R,(x,y) = PolynomialRing(FiniteField(32003), ["x","y"])
    I = ideal(R,[x+13*y,x^2*y-12*y^2-x])
    singular_assure(I)
    res = Int32[2, 3], Int32[1, 13, 1, 31991, 32002], Int32[1, 0, 0, 1, 2, 1, 0, 2, 1, 0]
    @test Oscar.convert_singular_ideal_to_array(I.gens.S) == res
    @test Singular.equal(I.gens.S, Oscar.convert_ff_gb_array_to_singular_ideal(Int32(2), res[1], res[2], res[3], base_ring(I.gens.S)))
    R, (x1,x2,x3,x4) = PolynomialRing(FiniteField(next_prime(2^28)), ["x1", "x2", "x3", "x4"])
    I = ideal(R,[x1+2*x2+2*x3+2*x4-1,
            x1^2+2*x2^2+2*x3^2+2*x4^2-x1,
            2*x1*x2+2*x2*x3+2*x3*x4-x2,
            x2^2+2*x1*x3+2*x2*x4-x3])

    f4(I);
    G = Singular.Ideal(I.gens.Sx,
            (I.gens.Sx).(
                         [x1 + 2*x2 + 2*x3 + 2*x4 - 1, x3^2 + 2*x2*x4 + 76695850*x3*x4 + 115043772*x4^2 + 115043768*x2 - 76695846*x3 - 38347924*x4, x2*x3 - 2*x2*x4 - 38347926*x3*x4 + 76695842*x4^2 - 57521884*x2 + 38347923*x3 - 115043767*x4, x2^2 + 2*x2*x4 - 115043767*x3*x4 - 38347921*x4^2 - 38347923*x2 + 115043768*x3 - 76695846*x4, x3*x4^2 - 29826161*x4^3 + 14913081*x2*x4 + 56338306*x3*x4 + 129246702*x4^2 - 4971027*x2 - 8285045*x3 - 9942054*x4, x2*x4^2 + 89478486*x4^3 + 29826162*x2*x4 - 4971027*x3*x4 - 29826162*x4^2 - 126761189*x2 + 9942054*x3, x4^4 + 35851649*x4^3 - 35550375*x2*x4 - 17256326*x3*x4 - 36956322*x4^2 - 76950494*x2 + 85955250*x3 - 101027337*x4]))
    @test Singular.equal(I.gb.S, G)

    R, (x1,x2,x3,x4) = PolynomialRing(QQ, ["x1", "x2", "x3", "x4"])
    I = ideal(R,[x1+2*x2+2*x3+2*x4-1,
            x1^2+2*x2^2+2*x3^2+2*x4^2-x1,
            2*x1*x2+2*x2*x3+2*x3*x4-x2,
            x2^2+2*x1*x3+2*x2*x4-x3])
    @test msolve(I) == [[22962737360215680304751609438863//40564819207303340847894502572032, 1513002450019512169734458246787//10141204801825835211973625643008, 5182958262225197387756053216551//20282409603651670423947251286016, -7616885400984613182878492853665//40564819207303340847894502572032], [71395296070785323807623019368331//162259276829213363391578010288128, 12459851249697358862962113742967//40564819207303340847894502572032, 8580291392571573446468706870643//81129638414606681695789005144064, -21567997404718562552808373253301//162259276829213363391578010288128], [1, 0, 0, 0], [61998353219819930045909653815250323//83076749736557242056487941267521536, 38792604615627757006264148264699325//166153499473114484112975882535043072, -30673256184438941166467729397275787//166153499473114484112975882535043072, 12959048085548496170781868584847807//166153499473114484112975882535043072], [121755026932871067568746135873757//649037107316853453566312041152512, 25427246649357873547634679821667//324518553658426726783156020576256, 47765698061266159189992487572045//649037107316853453566312041152512, 165020848832009286713521105423667//649037107316853453566312041152512], [1690200800304305868662270940465//5070602400912917605986812821504, -1//633825300114114700748351602688, -1//316912650057057350374175801344, 3380401600608611737324541881003//10141204801825835211973625643008]]
    I = ideal(R,[x1-1,x1-1])
    @test msolve(I) == []
    I = ideal(R,[x1-1,x1+1])
    @test msolve(I) == []
end
